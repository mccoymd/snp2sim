View(distplotdata)
distplotdata <- distdata[distdata$ligand %in% sel, ]
distplotdata <- distdata[distdata$ligand %in% sel1, ]
ggsave(paste0(path, "lig_violin_1.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
distplotdata <- distdata[distdata$ligand %in% sel2, ]
ggsave(paste0(path, "lig_violin_1.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
ggsave(paste0(path, "lig_violin.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
distplotdata <- distdata[distdata$ligand %in% sel1, ]
ggsave(paste0(path, "lig_violin_1.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
View(data)
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
distplotdata <- distdata
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
distplotdata <- distdata[distdata$ligand !="pethidine" , ]
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 10, height = 6.5)
args <- c("/Users/vikram/Documents/georgetown/summer_2019/run_workflow/snp2simresults/variantSimulations/PDL1/results/analysis/pdl1-SMI_53P_68L_86W_94M_95R_97V_115T_wt/weighted_vinaSummary_PDL1.txt", "False")
library(ggplot2)
library(htmlwidgets)
library(highcharter)
library(viridis)
library(webshot)
path = paste0(dirname(args[1]), "/figures/")
table <- read.table(args[1], header = TRUE, sep = "")
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
View(fulldata)
library(ggplot2)
library(htmlwidgets)
library(highcharter)
library(viridis)
library(webshot)
path = paste0(dirname(args[1]), "/figures/")
table <- read.table(args[1], header = TRUE, sep = "")
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
View(fulldata)
library(ggplot2)
library(htmlwidgets)
library(highcharter)
library(viridis)
library(webshot)
path = paste0(dirname(args[1]), "/figures/")
table <- read.table(args[1], header = TRUE, sep = "")
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
View(fulldata)
fulldata$weighted_affinity <- fulldata$affinity * fulldata$weight
wtdata <- subset(fulldata, fulldata$variant == "wt")
fulldata <- fulldata[fulldata$variant != "wt",]
#wtdata <- aggregate(affinity ~ ligand, wtdata, min)
wtdata <- aggregate(weighted_affinity ~ ligand, wtdata, sum)
colnames(wtdata)[colnames(wtdata) == "weighted_affinity"] <-
"wtAffinity"
weighted_avgs <- aggregate(weighted_affinity ~ ligand + variant, fulldata, sum)
fulldata <- subset(fulldata, select = -c(rank, rmsd_ub, rmsd_lb, weighted_affinity, scaffold, affinity))
fulldata <- merge(fulldata, wtdata, by = "ligand")
fulldata <- merge(fulldata, weighted_avgs, by = c("ligand","variant"))
fulldata <- unique(fulldata)
fulldata$relEnergy <- fulldata$weighted_affinity - fulldata$wtAffinity
fulldata$perChange <-
(fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
library(ggplot2)
library(htmlwidgets)
library(highcharter)
library(viridis)
library(webshot)
path = paste0(dirname(args[1]), "/figures/")
table <- read.table(args[1], header = TRUE, sep = "")
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
if(args[2] == "True"){
fulldata$part_weighted_affinity <- fulldata$affinity * fulldata$weight
affinities <- aggregate(part_weighted_affinity ~ ligand + trial + variant, fulldata, sum)
colnames(affinities)[colnames(affinities) == "part_weighted_affinity"] <-
"weighted_affinity"
fulldata <- merge(fulldata, affinities, by = c("ligand", "trial", "variant"))
wtdata.mean <- aggregate(weighted_affinity ~ ligand, wtdata, mean)
wtdata <- aggregate(weighted_affinity ~ ligand, wtdata, sd)
wtdata <- merge(wtdata, wtdata.mean, by="ligand")
colnames(wtdata)[colnames(wtdata) == "affinity.x"] <-
"wtstd"
colnames(wtdata)[colnames(wtdata) == "affinity.y"] <-
"wtmeanAffinity"
fulldata <- merge(fulldata, wtdata, by = "ligand")
colnames(fulldata)[colnames(fulldata) == "weighted_affinity"] <-
"absAffinity"
colnames(fulldata)[colnames(fulldata) == "wtmeanAffinity"] <-
"wtAffinity"
#for distribution plots
fulldata$trialRelEnergy <- fulldata$absAffinity-fulldata$wtAffinity
distdata <- fulldata
error <- aggregate(absAffinity ~ ligand + variant, fulldata, sd)
colnames(error)[colnames(error) == "absAffinity"] <- "std"
fulldata <- merge(fulldata, error, by = c("ligand", "variant"))
meanval <- aggregate(absAffinity ~ ligand + variant, fulldata, mean)
colnames(meanval)[colnames(meanval) == "absAffinity"] <- "meanAffinity"
fulldata <- merge(fulldata, meanval,  by = c("ligand", "variant"))
fulldata <- fulldata[!duplicated(fulldata[,c("ligand", "variant", "meanAffinity")]),]
fulldata$relEnergy <- fulldata$meanAffinity-fulldata$wtAffinity
fulldata$varStd <- fulldata$std
fulldata$std <- fulldata$wtstd +fulldata$std
fulldata$perChange <- (fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
fulldata$perSD <- (fulldata$std / abs(fulldata$wtAffinity)) * 100
fulldata <- subset(fulldata, select = -c(rank, rmsd_ub, rmsd_lb, absAffinity, scaffold, trial))
} else {
fulldata$weighted_affinity <- fulldata$affinity * fulldata$weight
wtdata <- subset(fulldata, fulldata$variant == "wt")
fulldata <- fulldata[fulldata$variant != "wt",]
#wtdata <- aggregate(affinity ~ ligand, wtdata, min)
wtdata <- aggregate(weighted_affinity ~ ligand, wtdata, sum)
colnames(wtdata)[colnames(wtdata) == "weighted_affinity"] <-
"wtAffinity"
weighted_avgs <- aggregate(weighted_affinity ~ ligand + variant, fulldata, sum)
fulldata <- subset(fulldata, select = -c(rank, rmsd_ub, rmsd_lb, weighted_affinity, scaffold, affinity))
fulldata <- merge(fulldata, wtdata, by = "ligand")
fulldata <- merge(fulldata, weighted_avgs, by = c("ligand","variant"))
fulldata <- unique(fulldata)
fulldata$relEnergy <- fulldata$weighted_affinity - fulldata$wtAffinity
fulldata$perChange <-
(fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
}
old_path <- path
args <- c("/Users/vikram/Documents/georgetown/summer_2019/opioid_receptor/mccoy_snp2sim_data/variantSimulations/OPRM1/results/analysis/153V_234P_235M_235N_238I_302I_wt/vinaSummary_OPRM1.txt", "True")
library(ggplot2)
library(htmlwidgets)
library(highcharter)
library(viridis)
library(webshot)
path = paste0(dirname(args[1]), "/figures/")
table <- read.table(args[1], header = TRUE, sep = "")
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
wtdata <- subset(fulldata, fulldata$variant == "wt")
fulldata <- fulldata[fulldata$variant != "wt",]
if(args[2] == "True"){
wtdata.mean <- aggregate(affinity ~ ligand, wtdata, mean)
wtdata <- aggregate(affinity ~ ligand, wtdata, sd)
wtdata <- merge(wtdata, wtdata.mean, by="ligand")
colnames(wtdata)[colnames(wtdata) == "affinity.x"] <-
"wtstd"
colnames(wtdata)[colnames(wtdata) == "affinity.y"] <-
"wtmeanAffinity"
fulldata <- merge(fulldata, wtdata, by = "ligand")
colnames(fulldata)[colnames(fulldata) == "affinity"] <-
"absAffinity"
colnames(fulldata)[colnames(fulldata) == "wtmeanAffinity"] <-
"wtAffinity"
#for distribution plots
fulldata$trialRelEnergy <- fulldata$absAffinity-fulldata$wtAffinity
distdata <- fulldata
error <- aggregate(absAffinity ~ ligand + variant, fulldata, sd)
colnames(error)[colnames(error) == "absAffinity"] <- "std"
fulldata <- merge(fulldata, error, by = c("ligand", "variant"))
meanval <- aggregate(absAffinity ~ ligand + variant, fulldata, mean)
colnames(meanval)[colnames(meanval) == "absAffinity"] <- "meanAffinity"
fulldata <- merge(fulldata, meanval,  by = c("ligand", "variant"))
fulldata <- fulldata[!duplicated(fulldata[,c("ligand", "variant", "meanAffinity")]),]
fulldata$relEnergy <- fulldata$meanAffinity-fulldata$wtAffinity
fulldata$varStd <- fulldata$std
fulldata$std <- fulldata$wtstd +fulldata$std
fulldata$perChange <- (fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
fulldata$perSD <- (fulldata$std / abs(fulldata$wtAffinity)) * 100
fulldata <- subset(fulldata, select = -c(rank, rmsd_ub, rmsd_lb, absAffinity, scaffold, trial))
} else {
wtdata <- aggregate(affinity ~ ligand, wtdata, min)
wtdata <- merge(wtdata, wtdata.mean, by="ligand")
fulldata <- merge(fulldata, wtdata, by = "ligand")
fulldata$relEnergy <- fulldata$affinity.x - fulldata$affinity.y
colnames(fulldata)[colnames(fulldata) == "affinity.x"] <-
"absAffinity"
colnames(fulldata)[colnames(fulldata) == "affinity.y"] <-
"wtAffinity"
fulldata$perChange <-
(fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
}
plotdata = fulldata[fulldata$ligand %in% c('morphine','endomorphine1','fentanyl',"oxycodone")]
plotdata = fulldata[fulldata$ligand %in% c('morphine','endomorphine1','fentanyl',"oxycodone"),]
plotdata = distdata[distdata$ligand %in% c('morphine','endomorphine1','fentanyl',"oxycodone"),]
ggplot(plotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_dotplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none"),
width = 15, height = 10)
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none"))
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none"),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "none"),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom"),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_box.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 7, height = 6)
View(plotdata)
colnames(plotdata)[5] = "Variant"
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(Variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_violin.png"),
ggplot(plotdata, aes(Variant, trialRelEnergy, color = Variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 7, height = 6)
ggsave(paste0(path, "select_lig_box.png"),
ggplot(plotdata, aes(Variant, trialRelEnergy, color = Variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, nrow = 2, ncol = 2) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()),
width = 7, height = 6)
