library(ggplot2)
table <- read.table("vinaSummary", header=TRUE, sep="\t")
table <- read.table("vinaSummary.txt", header=TRUE, sep="\t")
library(ggplot2)
table <- read.table("vinaSummary.txt", header=TRUE, sep="\t")
table <- read.table("vinaSummary.txt", header=TRUE, sep="")
View(table)
library(ggplot2)
table <- read.table("vinaSummary.txt", header=TRUE, sep="")
View(table)
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
wtdata <- subset(fulldata, fulldata$variant == "wt")
fulldata <- fulldata[fulldata$variant != "wt",]
View(wtdata)
wtdata <- aggregate(affinity ~ ligand, wtdata, min)
View(fulldata)
fulldata <- merge(fulldata, wtdata, by = "ligand")
fulldata$relEnergy <- fulldata$affinity.x - fulldata$affinity.y
colnames(fulldata)[colnames(fulldata) == "affinity.x"] <- "absAffinity"
colnames(fulldata)[colnames(fulldata) == "affinity.y"] <- "wtAffinity"
View(fulldata)
ggplot(fulldata, aes(ligand, relEnergy, fill = scaffold)) +
theme_light() +
theme(text=element_text(size=15)) +
geom_bar(stat="identity",position=position_dodge()) +
labs(y="Binding Affinity Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90)) +
facet_grid(. ~ variant)
ggplot(fulldata, aes(ligand, relEnergy, fill = scaffold)) +
theme_light() +
theme(text=element_text(size=15)) +
geom_bar(stat="identity",position=position_dodge()) +
labs(y="Binding Affinity Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90)) +
facet_grid(. ~ variant) + coord_polar()
ggplot(fulldata, aes(ligand, relEnergy, fill = scaffold)) +
theme_minimal() +
theme(text=element_text(size=15)) +
geom_bar(stat="identity",position=position_dodge()) +
labs(y="Binding Affinity Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90)) +
facet_grid(. ~ variant)
ligSet
LigClass <- sapply(ligSet, function(x){gsub("\\d+$","")})
LigClass <- sapply(ligSet, function(x){gsub("\\d+$","",x)})
LigClass
LigClass <- sapply(ligSet, function(x){gsub("\\d+$|_+$","",x) })
LigClass
LigClass <- sapply(ligSet, function(x){gsub("\\d+$&_+$","",x) })
LigClass <- sapply(ligSet, function(x){gsub("\\d+$||_+$","",x) })
LigClass <- sapply(ligSet, function(x){gsub("_+$","",gsub("\\d+$","",x))})
LigClass
LigClass <- unique(sapply(ligSet, function(x){gsub("_+$","",gsub("\\d+$","",x))}))
LigClass
fulldata$ligand_class <- sapply(fulldata$ligand, function(x){gsub("\\d+$&_+$","",x) })
fulldata$ligand_class <- sapply(fulldata$ligand, function(x){gsub("_+$","",gsub("\\d+$","",x))})
View(wtdata)
