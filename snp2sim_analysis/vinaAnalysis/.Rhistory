path = paste0(dirname(args[1]), "/figures/")
table <- read.table(args[1], header = TRUE, sep = "")
pdbSet <- unique(table$scaffold)
ligSet <- unique(table$ligand)
varSet <- unique(table$variant)
data <- table
#fulldata <- do.call(rbind, data)
#fulldata <- fulldata[fulldata$rank == 1,]
fulldata <- data[data$rank == 1, ]
wtdata <- subset(fulldata, fulldata$variant == "wt")
fulldata <- fulldata[fulldata$variant != "wt",]
if(args[2] == "True"){
wtdata.mean <- aggregate(affinity ~ ligand, wtdata, mean)
wtdata <- aggregate(affinity ~ ligand, wtdata, sd)
wtdata <- merge(wtdata, wtdata.mean, by="ligand")
colnames(wtdata)[colnames(wtdata) == "affinity.x"] <-
"wtstd"
colnames(wtdata)[colnames(wtdata) == "affinity.y"] <-
"wtmeanAffinity"
fulldata <- merge(fulldata, wtdata, by = "ligand")
colnames(fulldata)[colnames(fulldata) == "affinity"] <-
"absAffinity"
colnames(fulldata)[colnames(fulldata) == "wtmeanAffinity"] <-
"wtAffinity"
#for distribution plots
fulldata$trialRelEnergy <- fulldata$absAffinity-fulldata$wtAffinity
distdata <- fulldata
error <- aggregate(absAffinity ~ ligand + variant, fulldata, sd)
colnames(error)[colnames(error) == "absAffinity"] <- "std"
fulldata <- merge(fulldata, error, by = c("ligand", "variant"))
meanval <- aggregate(absAffinity ~ ligand + variant, fulldata, mean)
colnames(meanval)[colnames(meanval) == "absAffinity"] <- "meanAffinity"
fulldata <- merge(fulldata, meanval,  by = c("ligand", "variant"))
fulldata <- fulldata[!duplicated(fulldata[,c("ligand", "variant", "meanAffinity")]),]
fulldata$relEnergy <- fulldata$meanAffinity-fulldata$wtAffinity
fulldata$varStd <- fulldata$std
fulldata$std <- fulldata$wtstd +fulldata$std
fulldata$perChange <- (fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
fulldata$perSD <- (fulldata$std / abs(fulldata$wtAffinity)) * 100
fulldata <- subset(fulldata, select = -c(rank, rmsd_ub, rmsd_lb, absAffinity, scaffold, trial))
} else {
wtdata <- aggregate(affinity ~ ligand, wtdata, min)
wtdata <- merge(wtdata, wtdata.mean, by="ligand")
fulldata <- merge(fulldata, wtdata, by = "ligand")
fulldata$relEnergy <- fulldata$affinity.x - fulldata$affinity.y
colnames(fulldata)[colnames(fulldata) == "affinity.x"] <-
"absAffinity"
colnames(fulldata)[colnames(fulldata) == "affinity.y"] <-
"wtAffinity"
fulldata$perChange <-
(fulldata$relEnergy / abs(fulldata$wtAffinity)) * 100
}
distplotdata = distdata
ggplot(distplotdata, aes(variant, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank())
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = 'black')
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'black'))
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'black'), strip.text = element_text(colour = 'black'))
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white'), strip.text = element_text(colour = 'black'))
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'black'), strip.text = element_text(colour = 'black'))
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black'))
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')),
width = 15, height = 10)
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')),
width = 10, height = 6)
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')),
width = 11, height = 7)
distplotdata <- distdata[distdata$ligand %in% c("endomorphine1", "morphine", "fentanyl", "oxycodone")]
distplotdata <- distdata[distdata$ligand %in% c("endomorphine1", "morphine", "fentanyl", "oxycodone"),]
ggplot(distplotdata, aes(variant, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_text(angle = 90), legend.position = "none")
ggplot(distplotdata, aes(variant, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black'))
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
theme(legend.title = "Ligand"),
width = 11, height = 7)
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(fill = "Ligand"),
width = 11, height = 7)
distplotdata = distdata
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(fill = "Ligand"),
width = 11, height = 7)
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Ligand"),
width = 11, height = 7)
distplotdata <- distdata[distdata$ligand %in% c("endomorphine1", "morphine", "fentanyl", "oxycodone"),]
ggplot(distplotdata, aes(variant, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black'))
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant")
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 10, height = 6.5)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 7, height = 4)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant")
)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 6, height = 4)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 8, height = 4)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 8, height = 7)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 7, height = 6)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, ) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 7, height = 6)
View(distplotdata)
distplotdata$ligand <- gsub("oxycodone", "Oxycodone", distplotdata$ligand)
distplotdata$ligand <- gsub("morphine", "Morphine", distplotdata$ligand)
distplotdata$ligand <- gsub("endoMorphine1", "Endomorphin", distplotdata$ligand)
distplotdata$ligand <- gsub("fentanyl", "Fentanyl", distplotdata$ligand)
ggsave(paste0(path, "sel_lig_box.png"),
ggplot(distplotdata, aes(variant, trialRelEnergy, color = variant)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_boxplot() +
facet_wrap(.~ligand, ) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Variant"),
width = 7, height = 6)
distplotdata <- distdata
distplotdata$ligand <- gsub("endomorphine1", "endomorphin1", distplotdata$ligand)
distplotdata$ligand <- gsub("endomorphine2", "endomorphin2", distplotdata$ligand)
ggsave(paste0(path, "variant_violin.png"),
ggplot(distplotdata, aes(ligand, trialRelEnergy, color = ligand)) +
theme_light() +
theme(text = element_text(size = 15)) +
geom_hline(
yintercept = 0,
color = "black",
size = 1.3
) +
geom_violin() +
facet_wrap(.~variant) +
labs(y = "Binding Energy Relative to WT (kcal/mol)") +
theme(axis.text.x = element_blank(), legend.position = "bottom", axis.title.x = element_blank()) +
theme(strip.background = element_rect(fill = 'white', colour = 'gray'), strip.text = element_text(colour = 'black')) +
labs(color = "Ligand"),
width = 11, height = 7)
